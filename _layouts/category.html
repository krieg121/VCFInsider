---
layout: default
---

<div class="container page-content">
  {%- comment -%}
    Category hero using front-matter icon + accent.
    We DISPLAY the label exactly as authored (title > category > tag),
    and use a separate raw/slug value only for lookups.
  {%- endcomment -%}
  <div class="cat-hero" style="--cat-accent: {{ page.accent | default: '#0077C8' }}">
    {%- assign display_label = page.title | default: page.category | default: page.tag -%}
    {%- assign raw_label     = page.category | default: page.tag | default: page.title -%}

    <h1 class="title">
      {% if page.icon_class %}
        <i class="{{ page.icon_class }}"></i>
      {% elsif page.icon %}
        {{ page.icon }}
      {% endif %}
      {{ display_label }}
    </h1>

    {%- if page.description -%}
      <p class="desc">{{ page.description }}</p>
    {%- endif -%}
  </div>

  {%- comment -%}
    Build the post list by scanning site.posts so we catch BOTH:
    - plural 'categories: [...]'
    - singular 'category: ...'
    Then match by slug, de-dup, and sort newest-first.
  {%- endcomment -%}
  {%- assign target_slug = raw_label | slugify -%}
  {%- assign matched = "" | split: "" -%}

  {%- for p in site.posts -%}
    {%- assign hits = false -%}

   {%- if p.categories and p.categories != empty -%}
  {%- for c in p.categories -%}
    {%- assign cslug = c | slugify -%}
    {%- if cslug == target_slug -%}
      {%- assign hits = true -%}
      {%- break -%}
    {%- endif -%}
  {%- endfor -%}
{%- endif -%}


    {%- if hits == false and p.category -%}
  {%- assign cat_slug = p.category | slugify -%}
  {%- if cat_slug == target_slug -%}
    {%- assign hits = true -%}
  {%- endif -%}
{%- endif -%}


    {%- if hits -%}
      {%- assign matched = matched | push: p -%}
    {%- endif -%}
  {%- endfor -%}

  {%- comment -%} De-duplicate by URL (in case a post carries both forms) {%- endcomment -%}
  {%- assign unique_posts = "" | split: "" -%}
  {%- assign seen_urls = "" | split: "" -%}
  {%- for p in matched -%}
    {%- unless seen_urls contains p.url -%}
      {%- assign seen_urls = seen_urls | push: p.url -%}
      {%- assign unique_posts = unique_posts | push: p -%}
    {%- endunless -%}
  {%- endfor -%}

  {%- assign posts = unique_posts | sort: "date" | reverse -%}

  {%- if posts and posts.size > 0 -%}
    <div class="articles-grid">
      {%- for post in posts -%}
        <article class="article-card">
          {%- assign card_image = post.image | default: post.featured_image -%}
          {%- if card_image -%}
            <img class="article-image"
                 src="{{ card_image | relative_url }}"
                 alt="{{ post.title | escape }}"
                 loading="lazy"
                 decoding="async">
          {%- endif -%}

          <div class="article-content">
            <span class="article-category">{{ display_label }}</span>

            {%- assign now  = site.time | date: '%s' | plus: 0 -%}
            {%- assign then = post.date  | date: '%s' | plus: 0 -%}
            {%- assign age  = now | minus: then -%}

            <h2 class="article-title">
              <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
              {%- if age < 604800 -%}<span class="badge-new pulse">NEW</span>{%- endif -%}
            </h2>

            <p class="article-excerpt">
              {{ post.excerpt | default: post.content | strip_html | truncate: 160 }}
            </p>

            <div class="article-meta">
              <time datetime="{{ post.date | date_to_xmlschema }}">
                {{ post.date | date: "%b %-d, %Y" }}
              </time>
              <a class="read-more" href="{{ post.url | relative_url }}">Read</a>
            </div>
          </div>
        </article>
      {%- endfor -%}
    </div>
  {%- else -%}
    <p>No posts in this category yet.</p>
  {%- endif -%}

  {{ content }}
</div>
